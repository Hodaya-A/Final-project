const XLSX = require("xlsx");
const dayjs = require("dayjs");

const today = dayjs();

// ×—× ×•×ª 1: "Fresh Market" - ×ž×•×›×¨: shop1@example.com
const shop1Products = [
  // ×œ×—× ×•×ž××¤×™× ×˜×¨×™×™×
  [
    "1001",
    "×—×œ×” ×‘×™×ª×™×ª",
    12.9,
    10.9,
    "×œ×—× ×•×ž××¤×™× ×˜×¨×™×™×",
    30,
    today.add(2, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×—×œ×”",
    "×—×œ×” ×˜×¨×™×™×” ××¤×•×™×” ×ž×“×™ ×™×•×, ×¢× ×©×•×ž×©×•×",
  ],
  [
    "1002",
    "×œ×—× ×ž×—×ž×¦×ª",
    15.9,
    13.9,
    "×œ×—× ×•×ž××¤×™× ×˜×¨×™×™×",
    25,
    today.add(3, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×ž×—×ž×¦×ª",
    "×œ×—× ×ž×—×ž×¦×ª ×‘×¨×™× ×¢× ×§×ž×— ×ž×œ×",
  ],
  [
    "1003",
    "×‘×’×˜ ×¦×¨×¤×ª×™",
    8.9,
    7.5,
    "×œ×—× ×•×ž××¤×™× ×˜×¨×™×™×",
    40,
    today.add(1, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×‘×’×˜",
    "×‘×’×˜ ×˜×¨×™ ×¢× ×§×¨×•× ×¤×¨×™×š",
  ],

  // ×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×
  [
    "1004",
    "×—×œ×‘ 3% ×ª× ×•×‘×”",
    5.9,
    4.9,
    "×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×",
    60,
    today.add(5, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×—×œ×‘",
    "×—×œ×‘ ×˜×¨×™ 3% ×©×•×ž×Ÿ ×‘×§×¨×˜×•×Ÿ ×œ×™×˜×¨",
  ],
  [
    "1005",
    "×‘×™×¦×™× L",
    18.9,
    16.9,
    "×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×",
    50,
    today.add(14, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×‘×™×¦×™×",
    "×‘×™×¦×™× ×˜×¨×™×•×ª ×’×•×“×œ L ×ž×”×œ×•×œ",
  ],
  [
    "1006",
    "×§×•×˜×’×³ 5%",
    6.5,
    5.9,
    "×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×",
    45,
    today.add(7, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×§×•×˜×’",
    "×§×•×˜×’×³ ×ª× ×•×‘×” 5% ×©×•×ž×Ÿ 250 ×’×¨×",
  ],

  // ×ž×©×§××•×ª
  [
    "1007",
    "×ž×™×¥ ×ª×¤×•×–×™× ×˜×‘×¢×™",
    12.9,
    10.9,
    "×ž×©×§××•×ª",
    35,
    today.add(10, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×ž×™×¥",
    "×ž×™×¥ ×ª×¤×•×–×™× ×˜×¨×™ ×‘×œ×™ ×ª×•×¡×¤×ª ×¡×•×›×¨",
  ],
  [
    "1008",
    "×§×•×§×” ×§×•×œ×” 1.5 ×œ×™×˜×¨",
    6.9,
    5.5,
    "×ž×©×§××•×ª",
    80,
    today.add(90, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×§×•×œ×”",
    "×ž×©×§×” ×§×•×œ×” ×‘×§×‘×•×§ 1.5 ×œ×™×˜×¨",
  ],

  // ×—×˜×™×¤×™× ×•×ž×ª×•×§×™×
  [
    "1009",
    "×‘×™×¡×œ×™ ×’×¨×™×œ",
    4.5,
    3.9,
    "×—×˜×™×¤×™× ×•×ž×ª×•×§×™×",
    100,
    today.add(60, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×‘×™×¡×œ×™",
    "×—×˜×™×£ ×‘×™×¡×œ×™ ×‘×˜×¢× ×’×¨×™×œ 70 ×’×¨×",
  ],
  [
    "1010",
    "×©×•×§×•×œ×“ ×¤×¨×”",
    7.9,
    6.5,
    "×—×˜×™×¤×™× ×•×ž×ª×•×§×™×",
    70,
    today.add(120, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×©×•×§×•×œ×“",
    "×©×•×§×•×œ×“ ×—×œ×‘ ×¤×¨×” 100 ×’×¨×",
  ],

  // ×‘×©×¨ ×•×“×’×™×
  [
    "1011",
    "×—×–×” ×¢×•×£ ×˜×¨×™",
    35.9,
    32.9,
    "×‘×©×¨ ×•×“×’×™×",
    20,
    today.add(3, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×¢×•×£",
    '×—×–×” ×¢×•×£ ×˜×¨×™ ×œ×ž× ×” ×§"×’',
  ],
  [
    "1012",
    "×¤×™×œ×” ×¡×œ×ž×•×Ÿ",
    89.9,
    79.9,
    "×‘×©×¨ ×•×“×’×™×",
    15,
    today.add(2, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×¡×œ×ž×•×Ÿ",
    '×¤×™×œ×” ×¡×œ×ž×•×Ÿ ×˜×¨×™ × ×•×¨×‘×’×™ ×§"×’',
  ],

  // ×§×¤×•××™×
  [
    "1013",
    "×¤×™×¦×” ×ž×©×¤×—×ª×™×ª",
    29.9,
    24.9,
    "×§×¤×•××™×",
    30,
    today.add(180, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×¤×™×¦×”",
    "×¤×™×¦×” ×§×¤×•××” ×ž×©×¤×—×ª×™×ª ×¢× ×ª×•×¡×¤×•×ª",
  ],
  [
    "1014",
    "×™×¨×§×•×ª ×ž×¢×•×¨×‘×™×",
    12.9,
    9.9,
    "×§×¤×•××™×",
    40,
    today.add(365, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×™×¨×§×•×ª",
    "×©×§×™×ª ×™×¨×§×•×ª ×§×¤×•××™× ×ž×¢×•×¨×‘×™× 800 ×’×¨×",
  ],

  // ×©×™×ž×•×¨×™× ×•×‘×™×©×•×œ
  [
    "1015",
    "×¨×¡×§ ×¢×’×‘× ×™×•×ª",
    5.9,
    4.5,
    "×©×™×ž×•×¨×™× ×•×‘×™×©×•×œ",
    60,
    today.add(730, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×¨×¡×§",
    "×¨×¡×§ ×¢×’×‘× ×™×•×ª ××™×›×•×ª×™ 400 ×’×¨×",
  ],

  // ××•×¨×’× ×™ ×•×‘×¨×™××•×ª
  [
    "1016",
    "×§×™× ×•××” ××•×¨×’× ×™×ª",
    24.9,
    21.9,
    "××•×¨×’× ×™ ×•×‘×¨×™××•×ª",
    25,
    today.add(365, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×§×™× ×•××”",
    "×§×™× ×•××” ××•×¨×’× ×™×ª 500 ×’×¨× ×ž××•×©×¨×ª",
  ],
];

// ×—× ×•×ª 2: "Super Deal" - ×ž×•×›×¨: shop2@example.com
const shop2Products = [
  // ×œ×—× ×•×ž××¤×™× ×˜×¨×™×™×
  [
    "2001",
    "×¤×™×ª×” ××—×™×“",
    4.9,
    3.9,
    "×œ×—× ×•×ž××¤×™× ×˜×¨×™×™×",
    50,
    today.add(2, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×¤×™×ª×”",
    "×¤×™×ª×•×ª ×˜×¨×™×•×ª ×—×‘×™×œ×ª 6",
  ],
  [
    "2002",
    "×¨×•×œ×™× ×ž×œ×•×—×™×",
    16.9,
    14.9,
    "×œ×—× ×•×ž××¤×™× ×˜×¨×™×™×",
    30,
    today.add(3, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×¨×•×œ×™×",
    "×¨×•×œ×™× ×ž×œ×•×—×™× ×¢× ×’×‘×™× ×” ×•×–×¢×ª×¨",
  ],

  // ×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×
  [
    "2003",
    "×—×œ×‘ ×©×•×§×•×œ×“",
    6.9,
    5.5,
    "×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×",
    70,
    today.add(7, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×©×•×§×•",
    "×—×œ×‘ ×©×•×§×•×œ×“ ×˜×¨×™ ×œ×™×˜×¨",
  ],
  [
    "2004",
    "×’×‘×™× ×” ×¦×”×•×‘×”",
    22.9,
    19.9,
    "×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×",
    40,
    today.add(30, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×’×‘×™× ×”",
    "×’×‘×™× ×” ×¦×”×•×‘×” ×¤×¨×•×¡×” 400 ×’×¨×",
  ],
  [
    "2005",
    "×©×ž× ×ª ×ž×ª×•×§×”",
    7.9,
    6.9,
    "×—×œ×‘, ×‘×™×¦×™× ×•×¡×œ×˜×™×",
    35,
    today.add(14, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×©×ž× ×ª",
    '×©×ž× ×ª ×ž×ª×•×§×” 38% 250 ×ž"×œ',
  ],

  // ×ž×©×§××•×ª
  [
    "2006",
    "×ž×™× ×ž×™× ×¨×œ×™×",
    3.5,
    2.9,
    "×ž×©×§××•×ª",
    100,
    today.add(365, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×ž×™×",
    "×ž×™× ×ž×™× ×¨×œ×™× 1.5 ×œ×™×˜×¨",
  ],
  [
    "2007",
    "×ª×” ×§×¨ ××¤×¨×¡×§",
    5.9,
    4.9,
    "×ž×©×§××•×ª",
    60,
    today.add(90, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×ª×”",
    "×ª×” ×§×¨ ×‘×˜×¢× ××¤×¨×¡×§ 1.5 ×œ×™×˜×¨",
  ],

  // ×—×˜×™×¤×™× ×•×ž×ª×•×§×™×
  [
    "2008",
    "×‘×ž×‘×”",
    4.9,
    3.5,
    "×—×˜×™×¤×™× ×•×ž×ª×•×§×™×",
    120,
    today.add(120, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×‘×ž×‘×”",
    "×‘×ž×‘×” ××•×¡× ×©×§×™×ª 80 ×’×¨×",
  ],
  [
    "2009",
    "×¢×•×’×™×•×ª ××•×¨××•",
    9.9,
    7.9,
    "×—×˜×™×¤×™× ×•×ž×ª×•×§×™×",
    80,
    today.add(180, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=××•×¨××•",
    "×¢×•×’×™×•×ª ××•×¨××• ×ž×§×•×¨×™ 176 ×’×¨×",
  ],

  // ×§×˜× ×™×•×ª ×•×“×’× ×™×
  [
    "2010",
    "××•×¨×– ×‘×¡×ž×˜×™",
    18.9,
    15.9,
    "×§×˜× ×™×•×ª ×•×“×’× ×™×",
    45,
    today.add(730, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=××•×¨×–",
    '××•×¨×– ×‘×¡×ž×˜×™ ××™×›×•×ª×™ ×§"×’',
  ],
  [
    "2011",
    "×¤×¡×˜×” ×¡×¤×’×˜×™",
    6.9,
    5.5,
    "×§×˜× ×™×•×ª ×•×“×’× ×™×",
    55,
    today.add(730, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×¤×¡×˜×”",
    "×¤×¡×˜×” ×¡×¤×’×˜×™ 500 ×’×¨×",
  ],

  // ×©×™×ž×•×¨×™× ×•×‘×™×©×•×œ
  [
    "2012",
    "×ª×™×¨×¡ ×©×™×ž×•×¨×™×",
    4.9,
    3.9,
    "×©×™×ž×•×¨×™× ×•×‘×™×©×•×œ",
    70,
    today.add(730, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×ª×™×¨×¡",
    "×ª×™×¨×¡ ×ž×ª×•×§ ×©×™×ž×•×¨×™× 400 ×’×¨×",
  ],
  [
    "2013",
    "×˜×•× ×” ×‘×©×ž×Ÿ",
    7.9,
    6.5,
    "×©×™×ž×•×¨×™× ×•×‘×™×©×•×œ",
    60,
    today.add(1095, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×˜×•× ×”",
    "×˜×•× ×” ×‘×©×ž×Ÿ ×¦×ž×—×™ 160 ×’×¨×",
  ],

  // ×—×“ ×¤×¢×ž×™ ×•×ž×˜×‘×—
  [
    "2014",
    "×›×•×¡×•×ª ×—×“ ×¤×¢×ž×™",
    8.9,
    6.9,
    "×—×“ ×¤×¢×ž×™ ×•×ž×˜×‘×—",
    40,
    today.add(1095, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×›×•×¡×•×ª",
    "×›×•×¡×•×ª ×¤×œ×¡×˜×™×§ ×—×“ ×¤×¢×ž×™ 50 ×™×—×™×“×•×ª",
  ],
  [
    "2015",
    "× ×™×™×¨ ××¤×™×™×”",
    12.9,
    9.9,
    "×—×“ ×¤×¢×ž×™ ×•×ž×˜×‘×—",
    35,
    today.add(1095, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=× ×™×™×¨",
    "× ×™×™×¨ ××¤×™×™×” 8 ×ž×˜×¨",
  ],

  // ×¤××¨× ×•×ª×™× ×•×§×•×ª
  [
    "2016",
    "×—×™×ª×•×œ×™× ×ž×™×“×” 4",
    49.9,
    44.9,
    "×¤××¨× ×•×ª×™× ×•×§×•×ª",
    25,
    today.add(1095, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×—×™×ª×•×œ×™×",
    "×—×™×ª×•×œ×™× ×ž×™×“×” 4 ××¨×™×–×ª ×—×™×¡×›×•×Ÿ",
  ],
  [
    "2017",
    "×ž×©×—×ª ×©×™× ×™×™×",
    14.9,
    11.9,
    "×¤××¨× ×•×ª×™× ×•×§×•×ª",
    40,
    today.add(730, "day").format("YYYY-MM-DD"),
    "https://via.placeholder.com/300?text=×ž×©×—×”",
    '×ž×©×—×ª ×©×™× ×™×™× ×§×•×œ×’×™×™×˜ 100 ×ž"×œ',
  ],
];

// ×™×¦×™×¨×ª ×§×•×‘×¥ ×œ×—× ×•×ª 1
const ws1 = XLSX.utils.aoa_to_sheet([
  [
    "×‘×¨×§×•×“",
    "×©× ×ž×•×¦×¨",
    "×ž×—×™×¨ ×ž×§×•×¨×™",
    "×ž×—×™×¨ ×ž×‘×¦×¢",
    "×§×˜×’×•×¨×™×”",
    "×›×ž×•×ª",
    "×ª××¨×™×š ×ª×¤×•×’×”",
    "×§×™×©×•×¨ ×ª×ž×•× ×”",
    "×ª×™××•×¨",
  ],
  ...shop1Products,
]);

const wb1 = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb1, ws1, "×ž×•×¦×¨×™×");
XLSX.writeFile(wb1, "../×—× ×•×ª1-FreshMarket.xlsx");

console.log("âœ… × ×•×¦×¨ ×§×•×‘×¥: ×—× ×•×ª1-FreshMarket.xlsx");
console.log(`   ×ž×›×™×œ ${shop1Products.length} ×ž×•×¦×¨×™×`);

// ×™×¦×™×¨×ª ×§×•×‘×¥ ×œ×—× ×•×ª 2
const ws2 = XLSX.utils.aoa_to_sheet([
  [
    "×‘×¨×§×•×“",
    "×©× ×ž×•×¦×¨",
    "×ž×—×™×¨ ×ž×§×•×¨×™",
    "×ž×—×™×¨ ×ž×‘×¦×¢",
    "×§×˜×’×•×¨×™×”",
    "×›×ž×•×ª",
    "×ª××¨×™×š ×ª×¤×•×’×”",
    "×§×™×©×•×¨ ×ª×ž×•× ×”",
    "×ª×™××•×¨",
  ],
  ...shop2Products,
]);

const wb2 = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb2, ws2, "×ž×•×¦×¨×™×");
XLSX.writeFile(wb2, "../×—× ×•×ª2-SuperDeal.xlsx");

console.log("âœ… × ×•×¦×¨ ×§×•×‘×¥: ×—× ×•×ª2-SuperDeal.xlsx");
console.log(`   ×ž×›×™×œ ${shop2Products.length} ×ž×•×¦×¨×™×`);

console.log("\nðŸ“‹ ×”×§×˜×’×•×¨×™×•×ª ×‘×§×‘×¦×™×:");
const categories1 = [...new Set(shop1Products.map((p) => p[4]))];
const categories2 = [...new Set(shop2Products.map((p) => p[4]))];
console.log("   ×—× ×•×ª 1:", categories1.join(", "));
console.log("   ×—× ×•×ª 2:", categories2.join(", "));
